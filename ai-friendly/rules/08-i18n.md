# Internationalization (i18n)

## Key Resolution Pattern

Ybyra resolves labels automatically via i18n keys. **No labels are hardcoded in schema definitions.**

### Key patterns:

| Pattern | Example | Resolves to |
|---------|---------|-------------|
| `{domain}.title` | `person.title` | "Pessoa" |
| `{domain}.fields.{field}` | `person.fields.name` | "Nome" |
| `{domain}.fields.{field}.placeholder` | `person.fields.name.placeholder` | "Digite seu nome aqui" |
| `{domain}.groups.{group}` | `person.groups.basic` | "Informações Básicas" |
| `{domain}.actions.{action}` | `person.actions.custom` | "Enviar" |
| `common.actions.{action}` | `common.actions.create` | "Criar" |
| `common.actions.{action}.success` | `common.actions.create.success` | "Registro criado" |
| `common.actions.{action}.invalid` | `common.actions.create.invalid` | "Formulário inválido" |
| `common.actions.{action}.confirm` | `common.actions.destroy.confirm` | "Tem certeza?" |

## Locale File Structure

Each locale is a flat-ish object with nested keys:

```typescript
export const ptBR = {
  person: {
    title: "Pessoa",
    fields: {
      id: "ID",
      name: "Nome",
      "name.placeholder": "Digite seu nome aqui",
      email: "E-mail",
      "email.placeholder": "Informe seu melhor e-mail",
      phone: "Telefone",
      "phone.placeholder": "Ex.: (11) 99999-9999",
      birthDate: "Data de Nascimento",
      active: "Ativo",
      street: "Rua",
      "street.placeholder": "Informe a rua do endereço",
      city: "Cidade",
      "city.placeholder": "Digite a cidade",
    },
    groups: {
      basic: "Informações Básicas",
      address: "Endereço",
    },
    actions: {
      custom: "Enviar",
    },
  },
};
```

### Rules for locale files:
1. **Every field needs a label** — key: `{domain}.fields.{fieldName}`
2. **Placeholders are optional** — key: `{domain}.fields.{fieldName}.placeholder`
3. **Every group needs a label** — key: `{domain}.groups.{groupName}`
4. **Custom actions need labels** — key: `{domain}.actions.{actionName}`
5. **Standard actions use `common.*`** — already provided by `@ybyra/core` via `ptBR` export
6. **Domain title** — key: `{domain}.title`

## Framework-Specific i18n Setup

### React Web
```typescript
import { ptBR } from "@ybyra/core";
import { configureI18n } from "@ybyra/react-web";
import { ptBR as local } from "./locales/pt-BR";

export default configureI18n({
  resources: {
    "pt-BR": { translation: { ...ptBR, ...local } },
  },
  default: "pt-BR",
  fallback: "pt-BR",
});
```

### Vue + Quasar
```typescript
import { configureI18n } from "@ybyra/vue-quasar";
import { ptBR } from "@ybyra/core";
import { ptBR as local } from "./locales/pt-BR";

export const i18n = configureI18n({
  locale: "pt-BR",
  messages: {
    "pt-BR": { ...ptBR, ...local } as Record<string, unknown>,
  },
});
```

### SvelteKit
```typescript
// settings/i18n.ts — custom translate function
import { ptBR } from "@ybyra/core";
import { ptBR as local } from "./locales/pt-BR";

const messages = { ...ptBR, ...local } as Record<string, unknown>;

// Walk nested keys like "person.fields.name"
function walk(obj: Record<string, unknown>, path: string): string | undefined {
  const parts = path.split(".");
  let current: unknown = obj;
  for (let i = 0; i < parts.length; i++) {
    if (current == null || typeof current !== "object") return undefined;
    const record = current as Record<string, unknown>;
    const remaining = parts.slice(i).join(".");
    if (remaining in record && typeof record[remaining] === "string") {
      return record[remaining] as string;
    }
    current = record[parts[i]];
  }
  return typeof current === "string" ? current : undefined;
}

export function translate(key: string, params?: Record<string, unknown>): string {
  const value = walk(messages, key);
  if (value === undefined) return key;
  return params ? interpolate(value, params) : value;
}

export function hasTranslation(key: string): boolean {
  return walk(messages, key) !== undefined;
}

// settings/i18n-setup.ts
import { configureI18n } from "@ybyra/sveltekit";
import { translate, hasTranslation } from "./i18n";

configureI18n({ translate, hasTranslation });
```

## Adding a New Domain's Translations

When creating a new domain (e.g., "product"), create a locale file following this template:

```typescript
export const ptBR = {
  product: {
    title: "Produto",
    fields: {
      // one entry per field in the schema
      name: "Nome",
      "name.placeholder": "Nome do produto",
      price: "Preço",
      sku: "SKU",
      expirationDate: "Data de Vencimento",
    },
    groups: {
      // one entry per group in the schema
      general: "Informações Gerais",
    },
    actions: {
      // only custom actions need entries here
      // standard actions (add, view, edit, create, update, cancel, destroy)
      // are resolved from common.*
    },
  },
};
```

Then merge it with the core translations in your i18n setup:
```typescript
import { ptBR as local } from "./locales/pt-BR";
// spread: { ...ptBR, ...local }
```
